{"version":3,"sources":["../../../src/web.ts"],"names":["a"],"mappings":"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","file":"static/js/42.3bbf3511.chunk.js","sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n    async getPhoto(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            if (options.webUseInput || options.source === CameraSource.Photos) {\n                this.fileInputExperience(options, resolve);\n            }\n            else if (options.source === CameraSource.Prompt) {\n                let actionSheet = document.querySelector('pwa-action-sheet');\n                if (!actionSheet) {\n                    actionSheet = document.createElement('pwa-action-sheet');\n                    document.body.appendChild(actionSheet);\n                }\n                actionSheet.header = options.promptLabelHeader || 'Photo';\n                actionSheet.cancelable = false;\n                actionSheet.options = [\n                    { title: options.promptLabelPhoto || 'From Photos' },\n                    { title: options.promptLabelPicture || 'Take Picture' },\n                ];\n                actionSheet.addEventListener('onSelection', async (e) => {\n                    const selection = e.detail;\n                    if (selection === 0) {\n                        this.fileInputExperience(options, resolve);\n                    }\n                    else {\n                        this.cameraExperience(options, resolve, reject);\n                    }\n                });\n            }\n            else {\n                this.cameraExperience(options, resolve, reject);\n            }\n        });\n    }\n    async pickImages(_options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve) => {\n            this.multipleFileInputExperience(resolve);\n        });\n    }\n    async cameraExperience(options, resolve, reject) {\n        if (customElements.get('pwa-camera-modal')) {\n            const cameraModal = document.createElement('pwa-camera-modal');\n            document.body.appendChild(cameraModal);\n            try {\n                await cameraModal.componentOnReady();\n                cameraModal.addEventListener('onPhoto', async (e) => {\n                    const photo = e.detail;\n                    if (photo === null) {\n                        reject(new CapacitorException('User cancelled photos app'));\n                    }\n                    else if (photo instanceof Error) {\n                        reject(photo);\n                    }\n                    else {\n                        resolve(await this._getCameraPhoto(photo, options));\n                    }\n                    cameraModal.dismiss();\n                    document.body.removeChild(cameraModal);\n                });\n                cameraModal.present();\n            }\n            catch (e) {\n                this.fileInputExperience(options, resolve);\n            }\n        }\n        else {\n            console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements.`);\n            this.fileInputExperience(options, resolve);\n        }\n    }\n    fileInputExperience(options, resolve) {\n        let input = document.querySelector('#_capacitor-camera-input');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input';\n            input.type = 'file';\n            input.hidden = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const file = input.files[0];\n                let format = 'jpeg';\n                if (file.type === 'image/png') {\n                    format = 'png';\n                }\n                else if (file.type === 'image/gif') {\n                    format = 'gif';\n                }\n                if (options.resultType === 'dataUrl' ||\n                    options.resultType === 'base64') {\n                    const reader = new FileReader();\n                    reader.addEventListener('load', () => {\n                        if (options.resultType === 'dataUrl') {\n                            resolve({\n                                dataUrl: reader.result,\n                                format,\n                            });\n                        }\n                        else if (options.resultType === 'base64') {\n                            const b64 = reader.result.split(',')[1];\n                            resolve({\n                                base64String: b64,\n                                format,\n                            });\n                        }\n                        cleanup();\n                    });\n                    reader.readAsDataURL(file);\n                }\n                else {\n                    resolve({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                    cleanup();\n                }\n            });\n        }\n        input.accept = 'image/*';\n        input.capture = true;\n        if (options.source === CameraSource.Photos ||\n            options.source === CameraSource.Prompt) {\n            input.removeAttribute('capture');\n        }\n        else if (options.direction === CameraDirection.Front) {\n            input.capture = 'user';\n        }\n        else if (options.direction === CameraDirection.Rear) {\n            input.capture = 'environment';\n        }\n        input.click();\n    }\n    multipleFileInputExperience(resolve) {\n        let input = document.querySelector('#_capacitor-camera-input-multiple');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input-multiple';\n            input.type = 'file';\n            input.hidden = true;\n            input.multiple = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const photos = [];\n                // eslint-disable-next-line @typescript-eslint/prefer-for-of\n                for (let i = 0; i < input.files.length; i++) {\n                    const file = input.files[i];\n                    let format = 'jpeg';\n                    if (file.type === 'image/png') {\n                        format = 'png';\n                    }\n                    else if (file.type === 'image/gif') {\n                        format = 'gif';\n                    }\n                    photos.push({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                }\n                resolve({ photos });\n                cleanup();\n            });\n        }\n        input.accept = 'image/*';\n        input.click();\n    }\n    _getCameraPhoto(photo, options) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            const format = photo.type.split('/')[1];\n            if (options.resultType === 'uri') {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format,\n                    saved: false,\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = () => {\n                    const r = reader.result;\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: r,\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                };\n                reader.onerror = e => {\n                    reject(e);\n                };\n            }\n        });\n    }\n    async checkPermissions() {\n        if (typeof navigator === 'undefined' || !navigator.permissions) {\n            throw this.unavailable('Permissions API not available in this browser');\n        }\n        try {\n            // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n            // the specific permissions that are supported varies among browsers that implement the\n            // permissions API, so we need a try/catch in case 'camera' is invalid\n            const permission = await window.navigator.permissions.query({\n                name: 'camera',\n            });\n            return {\n                camera: permission.state,\n                photos: 'granted',\n            };\n        }\n        catch (_a) {\n            throw this.unavailable('Camera permissions are not available in this browser');\n        }\n    }\n    async requestPermissions() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n}\nconst Camera = new CameraWeb();\nexport { Camera };\n//# sourceMappingURL=web.js.map"],"sourceRoot":""}